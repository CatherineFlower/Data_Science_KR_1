# Domain DDoS Monitoring ‚Äî Data Science KR 1

> –ù–∞—Å—Ç–æ–ª—å–Ω–æ–µ –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å GUI –¥–ª—è **–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–æ–º–µ–Ω–æ–≤** –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ **–ø–æ–¥—Å—á—ë—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ DDoS-–∞—Ç–∞–∫ –ø–æ –¥–æ–º–µ–Ω—É**.  
> –°—Ç–µ–∫: **Python 3.12+, PyQt5, PostgreSQL 13+, psycopg2**, –ò–ò-–¥–µ—Ç–µ–∫—Ç–æ—Ä –Ω–∞ **IsolationForest**.

---

## üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç—ã

**–í—Ö–æ–¥**  
![Login](README_with_images/docs/img/login_screen.jpg)

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è**  
![Register](README_with_images/docs/img/register_screen.jpg)

**–°–ø–∏—Å–æ–∫ –¥–æ–º–µ–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**  
![Domains](README_with_images/docs/img/domains_list_screen.jpg)

**–ü—É—Å—Ç–æ–µ —Ä–∞–±–æ—á–µ–µ –æ–∫–Ω–æ**  
![Main](README_with_images/docs/img/main_empty_screen.jpg)

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞**  
![Add Domain](README_with_images/docs/img/add_domain_dialog.jpg)

---

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î –∏ –¥–∞–Ω–Ω—ã–µ

**ER-–¥–∏–∞–≥—Ä–∞–º–º–∞ (—Å—Ö–µ–º–∞ `app`)**  
![ERD](README_with_images/docs/img/erd_schema.jpg)

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (`app_user`)**  
![Users](README_with_images/docs/img/users_table.jpg)

**–î–æ–º–µ–Ω—ã –ø–æ–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (`tracked_domain`)**  
![Tracked domains](README_with_images/docs/img/tracked_domains_table.jpg)

**–ü–æ—Ç–æ–∫ –º–µ—Ç—Ä–∏–∫, 10-—Å–µ–∫—É–Ω–¥–Ω—ã–µ —Å—Ä–µ–∑—ã (`metric_sample`)**  
![Metric sample](README_with_images/docs/img/metric_sample_table.jpg)

**–ñ—É—Ä–Ω–∞–ª —Å–º–µ–Ω —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–æ–º–µ–Ω–∞ (`domain_state_log`)**  
![State log](README_with_images/docs/img/domain_state_log_table.jpg)

> –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö: —Ç–µ–∫—Å—Ç–æ–≤—ã–µ, —á–∏—Å–ª–æ–≤—ã–µ, –±—É–ª–µ–≤—ã, `timestamp`, ENUM (—Å–æ—Å—Ç–æ—è–Ω–∏—è), –º–∞—Å—Å–∏–≤—ã (`inet[]`), `JSONB`.  
> –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: `NOT NULL`, `UNIQUE`, `CHECK`. –ö–ª—é—á–∏: `PRIMARY KEY`, `FOREIGN KEY` + `ON DELETE/ON UPDATE`.

---

## üß† –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∫—Ä–∞—Ç–∫–æ)

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç –∞–∫–∫–∞—É–Ω—Ç –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç **–¥–æ–º–µ–Ω** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.  
2. –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å-–¥–µ—Ç–µ–∫—Ç–æ—Ä **–∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥** —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å—Ä–µ–∑ –º–µ—Ç—Ä–∏–∫ —Ç—Ä–∞—Ñ–∏–∫–∞:  
   `packets_per_s`, `uniq_ips`, `bytes_per_s`, `ok` (+ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ `src_ips inet[]`, `extra jsonb`).  
3. –ú–æ–¥–µ–ª—å **IsolationForest**, –æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ ¬´–Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö¬ª –º–µ—Ç—Ä–∏–∫–∞—Ö, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **score**.  
   –ï—Å–ª–∏ `score < threshold` ‚Äî —Ç–µ–∫—É—â–∏–π —Å—Ä–µ–∑ —Å—á–∏—Ç–∞–µ—Ç—Å—è **–∞–Ω–æ–º–∞–ª—å–Ω—ã–º**.  
4. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –º–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–æ–º–µ–Ω–∞ `active ‚Üî ddos`.  
   - –ø—Ä–∏ –∞–Ω–æ–º–∞–ª—å–Ω–æ–º —Å—Ä–µ–∑–µ –∏–∑ `active` ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –≤ `ddos`;  
   - –ø—Ä–∏ –Ω–µ–∞–Ω–æ–º–∞–ª—å–Ω–æ–º —Å—Ä–µ–∑–µ –∏–∑ `ddos` ‚Üí –≤–æ–∑–≤—Ä–∞—Ç –≤ `active`.  
5. **–ê—Ç–∞–∫–æ–π** —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–π —ç–ø–∏–∑–æ–¥ `active ‚Üí ddos ‚Üí active`.  
   –í –º–æ–º–µ–Ω—Ç –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ `active` —Å—á—ë—Ç—á–∏–∫ –∞—Ç–∞–∫ **—Ç–µ–∫—É—â–µ–≥–æ —á–∞—Å–∞** —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 1.  
6. –ü–æ—Ç–æ–∫ –º–µ—Ç—Ä–∏–∫, –∂—É—Ä–Ω–∞–ª —Å–º–µ–Ω —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –ø–æ—á–∞—Å–æ–≤—ã–µ –∏—Ç–æ–≥–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ë–î; ¬´—Ç–æ–ø —Å–±–æ–µ–≤¬ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á–∞—Å–æ–≤—ã–µ —Å—á—ë—Ç—á–∏–∫–∏ –∞—Ç–∞–∫.

---

## üîé –ö–∞–∫ –∏–º–µ–Ω–Ω–æ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –∞—Ç–∞–∫–∏

### 1) –ò—Å—Ç–æ—á–Ω–∏–∫ –∏ –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å
- –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä/–ø–∞—Ä—Å–µ—Ä –º–µ—Ç—Ä–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç **—Å —à–∞–≥–æ–º 10 —Å–µ–∫—É–Ω–¥** –Ω–∞ –∫–∞–∂–¥—ã–π –¥–æ–º–µ–Ω.  
- –ö–∞–∂–¥—ã–π —Å—Ä–µ–∑ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `app.metric_sample(domain_id, ts, ‚Ä¶, extra)`.

### 2) –ú–æ–¥–µ–ª—å –∏ –ø–æ—Ä–æ–≥
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **IsolationForest** (scikit-learn), –æ–±—É—á–µ–Ω–Ω—ã–π –Ω–∞ –Ω–æ—Ä–º–µ.  
- –ù–∞ –∫–∞–∂–¥–æ–º —Å—Ä–µ–∑–µ —Å—á–∏—Ç–∞–µ–º **score**; –∑–∞–¥–∞–Ω **–ø–æ—Ä–æ–≥** `threshold`.  
- –ï—Å–ª–∏ `score < threshold` ‚Üí —Å—Ä–µ–∑ **–∞–Ω–æ–º–∞–ª—å–Ω—ã–π**.

### 3) –ú–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–æ–º–µ–Ω–∞
- –°–æ—Å—Ç–æ—è–Ω–∏—è: `active` (–Ω–æ—Ä–º–∞) –∏ `ddos` (–∏–¥—ë—Ç –∞—Ç–∞–∫–∞).  
- –ü–µ—Ä–µ—Ö–æ–¥—ã:
  - `active` ‚Äî(–∞–Ω–æ–º–∞–ª—å–Ω—ã–π —Å—Ä–µ–∑)‚Üí `ddos`;  
  - `ddos` ‚Äî(–Ω–µ–∞–Ω–æ–º–∞–ª—å–Ω—ã–π —Å—Ä–µ–∑)‚Üí `active`.  
- –ö–∞–∂–¥–∞—è —Å–º–µ–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∏—à–µ—Ç –∑–∞–ø–∏—Å—å –≤ `app.domain_state_log` —Å `details JSONB`, –Ω–∞–ø—Ä–∏–º–µ—Ä:  
  `{ "model": "IsolationForest", "score": <—á–∏—Å–ª–æ> }`.

### 4) –ü–æ–¥—Å—á—ë—Ç –∞—Ç–∞–∫ –∏ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —á–∞—Å–∞–º
- **–ö–∞–∂–¥—ã–π —Ü–∏–∫–ª** `active ‚Üí ddos ‚Üí active` = **1 –∞—Ç–∞–∫–∞**.  
- –°—á—ë—Ç—á–∏–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è **–≤ —á–∞—Å–µ, –∫–æ–≥–¥–∞ —Å–æ—Å—Ç–æ—è–ª—Å—è –ø–µ—Ä–µ—Ö–æ–¥ `ddos ‚Üí active`**.  
- –í –∫–æ–Ω—Ü–µ —á–∞—Å–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏—Ç–æ–≥–∏ –ø–æ –¥–æ–º–µ–Ω—É –∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ ¬´—Ç–æ–ø–µ —Å–±–æ–µ–≤¬ª.

### 5) –ö—Ä–∞–µ–≤—ã–µ —Å–ª—É—á–∞–∏
- –î–æ–ª–≥–∞—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –∞—Ç–∞–∫–∞ –Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ, –ø–æ–∫–∞ –¥–æ–º–µ–Ω –Ω–µ –≤–µ—Ä–Ω—É–ª—Å—è –≤ `active`.  
- –ï—Å–ª–∏ –æ–¥–∏–Ω–æ—á–Ω—ã–µ –≤—Å–ø–ª–µ—Å–∫–∏ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã, –º–æ–∂–Ω–æ –ø–æ–¥–Ω—è—Ç—å `threshold` –∏–ª–∏ —Ç—Ä–µ–±–æ–≤–∞—Ç—å N –ø–æ–¥—Ä—è–¥ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö —Å—Ä–µ–∑–æ–≤ –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º –≤ `ddos`.

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–≤—Ö–æ–¥, ¬´–ú–æ–∏ –¥–æ–º–µ–Ω—ã¬ª, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞.  
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫ –∏ –¥–µ—Ç–µ–∫—Ü–∏—è –∞—Ç–∞–∫ –ø–æ IsolationForest + –ø–æ—Ä–æ–≥.  
- –ü–æ—á–∞—Å–æ–≤—ã–µ –∏—Ç–æ–≥–∏ –∏ ¬´—Ç–æ–ø —Å–±–æ–µ–≤¬ª.  
- –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å ROLLBACK, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ INFO/ERROR.  
- –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å (Windows/macOS/Linux).

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

> –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–∞–ø–∫–∞ **`src`**. –ó–∞–ø—É—Å–∫ ‚Äî **–¥–≤—É–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏**.

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install PyQt5 psycopg2-binary python-dotenv scikit-learn numpy
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î
–°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –≤ PostgreSQL (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ds_kr_1`) –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª –æ–∫—Ä—É–∂–µ–Ω–∏—è `src/.env`:
```
PGHOST=127.0.0.1
PGPORT=5432
PGDATABASE=mydb
PGUSER=postgres
PGPASSWORD=palchevsky

# Logging
LOG_LEVEL=INFO

# ML detector
ML_INTERVAL=3
BASELINE_SAMPLES=600
P_ATTACK=0.4
IFOREST_THRESHOLD=-0.1

ADMIN_LOGIN=admin
ADMIN_PASSWORD=123
```
> **–í–∞–∂–Ω–æ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã –∏ —Ç–∞–±–ª–∏—Ü –Ω–µ—Ç ‚Äî –∏—Ö –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –≤—Ä—É—á–Ω—É—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º PostgreSQL.

### –ó–∞–ø—É—Å–∫ (–¥–≤–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)

**–¢–µ—Ä–º–∏–Ω–∞–ª 1 ‚Äî –¥–µ—Ç–µ–∫—Ç–æ—Ä (–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–µ—Ç—Ä–∏–∫ + IsolationForest):**
```bash
python src/ml_detector.py
```

**–¢–µ—Ä–º–∏–Ω–∞–ª 2 ‚Äî GUI (PyQt5):**
```bash
python src/mainApp.py
```

–ó–∞–π–¥–∏—Ç–µ –ø–æ–¥ —Å–≤–æ–∏–º –ª–æ–≥–∏–Ω–æ–º, –¥–æ–±–∞–≤—å—Ç–µ –¥–æ–º–µ–Ω –∏ –Ω–∞–±–ª—é–¥–∞–π—Ç–µ, –∫–∞–∫ ¬´–∂—É—Ä–Ω–∞–ª —Å–æ—Å—Ç–æ—è–Ω–∏–π¬ª –∏ ¬´—Ç–æ–ø —Å–±–æ–µ–≤¬ª –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ –º–µ—Ä–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∞—Ç–∞–∫.

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **GUI**: PyQt5  
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL (ENUM, `inet[]`, JSONB, PK/FK/ON DELETE/ON UPDATE, –∏–Ω–¥–µ–∫—Å—ã)  
- **–î–æ—Å—Ç—É–ø –∫ –ë–î**: psycopg2 (prepared statements, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)  
- **ML**: IsolationForest (scikit-learn), –ø–æ—Ä–æ–≥ –ø–æ score  
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: `.env` —á–µ—Ä–µ–∑ `python-dotenv`

---

## üë• –ö–æ–º–∞–Ω–¥–∞ –∏ –≤–∫–ª–∞–¥
- **QA/Docs/–¢–∏–º–ª–∏–¥** ‚Äî —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏, README, —Å–∫—Ä–∏–Ω—à–æ—Ç—ã/–≤–∏–¥–µ–æ, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á.  
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –ë–î** ‚Äî —Å—Ö–µ–º–∞, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –∏–Ω–¥–µ–∫—Å—ã, —Å—Å—ã–ª–æ—á–Ω–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å.  
- **–ë—ç–∫–µ–Ω–¥/DAO** ‚Äî –¥–æ—Å—Ç—É–ø –∫ –ë–î, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –∑–∞–≥—Ä—É–∑–∫–∞ –º–µ—Ç—Ä–∏–∫.  
- **GUI-–≤–≤–æ–¥** ‚Äî —Ñ–æ—Ä–º—ã (–¥–æ–º–µ–Ω, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä–æ–≥–æ–≤).  
- **GUI-–æ—Ç—á—ë—Ç—ã** ‚Äî —Å–ø–∏—Å–∫–∏ –¥–æ–º–µ–Ω–æ–≤, —Ç–∞–±–ª–∏—Ü—ã, —Ñ–∏–ª—å—Ç—Ä—ã, —ç–∫—Å–ø–æ—Ä—Ç.

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ‚Äî –ø–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—é —Å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º/–∫–∞—Ñ–µ–¥—Ä–æ–π.
